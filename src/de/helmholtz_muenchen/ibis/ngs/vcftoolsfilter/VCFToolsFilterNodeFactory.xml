<?xml version="1.0" encoding="UTF-8"?>
<knimeNode icon="./icon_d_green.png" type="Source" xmlns="http://knime.org/node/v2.8" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://knime.org/node/v2.10 http://knime.org/node/v2.10.xsd">
    <name>VCFToolsFilter</name>
    
    <shortDescription>
        This node filters annotated VCF files.
    </shortDescription>
    
    <fullDescription>
        <intro>
        	This node allows to filter VCF files based on VCFTools.
        	Default values are taken from <a href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC4098776/">Carson et al. (2014)</a>.
        	The output is a VCF file containing the variants that have passed the filters.
        	All INFO fields are included in the output file but values might not be correct due to filtering.
        	However, the node provides the possibility to restore allele counts after filtering.
        </intro>
        
        <tab name="Options">
       	 	<option name="Path to VCFTool binary">
        		Select vcftools executable.
        	</option>
        	<option name="Further options">
        		VCFTools removes INFO fiels from VCF files. 
        		Allele counts (AC) and allele numbers (AN) are restored, if checked.
        	</option>	
        </tab>
        
        <tab name="Genotype Filter">
        	<option name="Filter by DP">
        		Genotypes are filtered by the given read depth (DP) threshold if this box is checked.
        		Make sure that DP values are given in the VCF file.
        	</option>
        	<option name="Filter by GQ">
        		Genotypes are filtered by the given genotype quality (GQ) threshold if this box is checked.
        		Make sure that GQ values are annotated in the VCF file.
        	</option>
        </tab>
        
        <tab name="Variant Filter">
        	<option name="Filter by FILTER is PASS">
        		Check this box, if you want to discard variants that have failed previous filters.
        	</option>
        	<option name="Filter by call rate">
        		Variants are discarded if the percentage of called genotypes is below the given threshold.
        	</option>
        	<option name="Filter by mean GQ">
        		Mean is computed internally, variants are completely removed if their mean GQ is below the threshold.
        	</option>
        </tab>
        
    </fullDescription>
    
    <ports>
        <inPort index="0" name="Input VCF">
        	Cell 0: Path to VCF file.
        </inPort>
        <outPort index="0" name="Filtered VCF">
        	Cell 0: Path to filtered VCF file.
        </outPort>
    </ports>    
</knimeNode>

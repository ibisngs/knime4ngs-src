<?xml version="1.0" encoding="UTF-8"?>
<knimeNode icon="./icon_d_green.png" type="Source" xmlns="http://knime.org/node/v2.8" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://knime.org/node/v2.8 http://knime.org/node/v2.8.xsd">
    <name>GATKUnifiedGenotyper</name>
    
    <shortDescription>
        SNP and Indel caller
    </shortDescription>
    
    <fullDescription>
        <intro>
        	This is a wrapper node for UnifiedGenotyper which is part of the Genome Analysis Toolkit (GATK). 
        	UnifiedGenotyper is based on a Bayesian genotype likelihood model and can identify SNPs and indels. 
        	Furthermore, it is possible to annotate all found variants with their corresponding dbSNP ID. 
        	Please note, that this tool has been deprecated in favor of HaplotypeCaller, a much more sophisticated variant caller that produces much better calls, especially on indels, and includes features that allow it to scale to much larger cohort sizes.
        	For further information, see the online documentation of the <a href="https://www.broadinstitute.org/gatk/guide/tooldocs/org_broadinstitute_gatk_tools_walkers_genotyper_UnifiedGenotyper.php">UnifiedGenotyper</a>.
    	</intro>
        <tab name="Options">
        	<option name="Choose variant type(s)">
            	This option enables you can choose whether to call only SNPs, only indels or both.
        	</option>
        	<option name="Variants from dbSNP">
            	Tick this option in order to annotate a variant with its ID from dbSNP.
            	The path to the dbSNP VCF file can be set in the preference page (tab). 
        	</option>
        	<option name="Output folder">
        		You can choose an output folder for the resulting VCF file.
        		Leave this field empty, if you want to use the folder of the input BAM files.
        	</option>
         	<option name="SNP calling"> 
            	Define the minimum base quality score for calling.
            	This is a threshold concerning the sequencing quality. 
            	The tool does not call SNPs at positions with a lower score.
        	</option>
        	<option name="Indel calling">
            	<b>Indel heterozygosity value</b>: The probabilistic model of UnifiedGenotyper uses the indel heterozygosity value for calculating the prior likelihood for an indel.<br />
            	<b>Minimum count of indel reads</b>: The option allows to set the minimum number of supporting reads for an indel. 
           		Decreasing this value leads to higher sensitivity, increased runtime and larger rates of false positives.<br />
            	<b>Minimum fraction of indel reads</b>: This option is similar to the option <i> minimum count of indel reads </i>. 
            	It is about the fraction of all supporting reads for variant that are required for considering the variant.<br />
            	<b> Indel gap open penalty</b>: The gap open penalty for an indel is the phred-scaled probability assumed for the occurrence of an indel start. 
            	It is used for calculating alignment scores.<br />
            	<b>Indel gap continuation penalty</b>: The gap continuation penalty for an indel is the phred-scaled probability assumed for the occurrence of an indel continuation. 
            	It is used for calculating alignment scores.<br />
        	</option> 
        
        	<option name="Further parameters">
        		<b>Sample contamination</b>: By setting this value above zero you force UnifiedGenotyper to ignore this fraction of reads for each genomic position.<br />
        		<b>Heterozygosity</b>: The probabilistic model of UnifiedGenotyper uses the heterozygosity value for calculating the prior likelihood for a mutation at a locus.<br />
        		<b>Fraction of deletions</b>: This value is a threshold for the maximum fraction of overall reads with a deletion at a locus. 
            	All loci below this threshold are examined for additional variants. <br />
        		<b>PCR error</b>: Estimate the expected probability of a PCR error. 
            	This probability is independent of the sequencing error rate. 
            	The PCR error rate is required for computing fragment-based likelihoods. <br />
            	<b>Confidence threshold for calling</b>: This threshold refers to the GATK variant quality score. 
           	 	GATK will consider all variants with a score equal or above this threshold as high-confidence variants.<br />
            	<b>Confidence threshold for emitting</b>: This threshold refers to the GATK variant quality score. 
             	GATK will output all variants with a score equal or above this threshold. 
            	All low-confidence variants according to the confidence threshold will be marked in the filter field of the VCF file.
        	</option>
            <option name="Malformed read filter">
            	When the length of the read does not match the length of the base quality score, GATK will report an error. 
            	By ticking this option you force GATK to skip such reads.
        	</option>
            <option name="Number of threads">
            	Set the number of threads to be used.<br />
            	Increasing the number of threads speeds up the node, but it also increases the memory required for the calculations.
        	</option>
        	
        </tab>
        <tab name="GATK">
        	<option name="Jave Memory">
        		Set the Java Memory (GB) for all threads.
        	</option>
        	<option name="Use BED file?">
            	Tick this option in order to call variants in certain genomic regions. 
            	You have to specify the intervals in a text file in BED format (Format explained at <a href="http://genome.ucsc.edu/FAQ/FAQformat.html"> http://genome.ucsc.edu/FAQ/FAQformat.html </a>) and select the file in the file browser.
        	</option>
        	<option name="Further options">
        		You can add further flags which will be added to the executed command.
        	</option>
        </tab>
        
        <tab name="Preference page">
        	<option name="HTE">
        		Set a threshold for repeated execution.
        		Only used if HTE is enabled in the preference page.
        	</option>
        	<option name="Path to dbSNP">
        		Set the path to the dbSNP data set file.
        		This will be done automatically if the path is already defined in the preference page. 
        	</option>
        	<option name="Path to reference sequence">
        		Set the path to the reference sequence.
        		This will be done automatically if the path is already defined in the preference page. 
        	</option>
        	<option name="Path to GATK jar file">
        		Set the path to GenomeAnalysisTK.jar.
        		This will be done automatically if the path is already defined in the preference page.  
       		</option>
        </tab>
        
    </fullDescription>
    
    <ports>
        <inPort index="0" name="In-Port">
        	Cell 0: Path to BAM file (BAM file for variant calling; it has to be indexed).
    	</inPort>
        <outPort index="0" name="Out-Port">
        	Cell 0: Path to VCF file.
    	</outPort>
    </ports>    
    <views>
        <view index="0" name="STDOUT / STDERR">STDOUT / STDERR</view>
    </views>
</knimeNode>

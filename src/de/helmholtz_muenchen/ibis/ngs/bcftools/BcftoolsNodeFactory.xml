<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE knimeNode PUBLIC "-//UNIKN//DTD KNIME Node 2.0//EN" "http://www.knime.org/Node.dtd">
<knimeNode icon="./icon_d_green.png" type="Source">
    <name>Bcftools</name>
    
    <shortDescription>
    Bcftools - Tool for calling SNPs and Indels
    </shortDescription>
    
    <fullDescription>
        <intro>
        Bcftools is a part of the Samtools package and is able to perform SNP and Indel calling. It can also concatenate BCF files, index BCFs for fast random access and convert BCF to VCF. 
        In addition, bcftools can operate on some VCFs (e.g. calling SNPs from GL-tagged VCFs), but not for all VCFs.<br></br>
        Source: <a href="http://samtools.sourceforge.net/">http://samtools.sourceforge.net/</a> 
        </intro>
        
         <option name="*************** Input Options ***************">
        </option>       
        <option name="Path to Bcftools">Select bcftools executable in the Samtools/Bcftools folder. This option is disabled if In-port table is available.</option>
        <option name="Select method"><ul><li>view: Convert between BCF and VCF, call variant candidates and estimate allele frequencies.</li>
       <li>index: Index sorted BCF for random access.</li>
        <li>cat: Concatenate BCF files. The input files are required to be sorted and have identical samples appearing in the same order.</li>
       <li> ld: Compute all-pair R^2 values</li>
        <li>ldpair: Compute R^2 values for given pairs</li> </ul>
         </option>

        <option name="Select Inputfile for selected method"> Requires BCF file for index, cat, ld, and ldpair. View requires a BCF or VCF inputfile. This option is disabled if In-port table is available.
        </option>

        <option name="Select second BCF file (cat only)"> Second BCF file which is merged with the first inputfile. Both files are required to be sorted and have identical samples appearing in the same order. 
        </option>

        <option name="Select list file (ldpair only)"> File containing the list for which R^2 values shall be computed.
        </option>

        <option name="############### View In/Out Options ###############">
        </option> 

        <option name="Sequence dictionary for VCF->BCF conversion"> Sequence dictionary (list of chromosome names). If input is in VCF and output in bcf format, a dictionary has to be specified in order to convert the format.
        </option>          

        <option name="List of sites (chr pos) or regions (BED) to output">
        </option> 
        
        <option name="List of samples to use"> List of samples to use. The first column in the input gives the sample names and the second gives the ploidy, which can only be 1 or 2. When the 2nd column is absent, the sample ploidy is assumed to be 2. In the output, the ordering of samples will be identical to the one in FILE
        </option> 
        
        <option name="Keep all possible alternate alleles at variant sites"> Retain all possible alternate alleles at variant sites. By default, the view command discards unlikely alleles. 
        </option> 
        
        <option name="Calculate LD for adjacent sites">
        </option> 
        
        <option name="PL generated by r921 or before (which generate old ordering)"> Activate to parse BCF files generated by samtools r921 or older which encodes PL in a different way.
        </option> 
        
        <option name="Suppress all individual genotype information">
        </option> 
        
        <option name="Skip sites where REF is not A/C/G/T">
        </option> 
        
        <option name="Output BCF instead of VCF"> Requires sequence dictionary if input is VCF
        </option> 
        
        <option name="Uncompressed BCF output"> Requires sequence dictionary if input is VCF
        </option> 
        
        <option name="Output the QCALL likelihood format">
        </option> 
        
        <option name="############### View Calling Options ###############">
        </option> 
        <option name="*************** Consensus/variant calling options ***************">
        </option> 
        
         <option name="Call SNPs"> 	Call variants using Bayesian inference. This option automatically invokes likelihood based analysis.
        </option> 
        
        <option name="Likelihood based analysis">  	Perform max-likelihood inference only, including estimating the site allele frequency, testing Hardy-Weinberg equilibrium and testing associations with LRT.
        </option> 
        
         <option name="Call genotypes at variant sites"> Forces SNP calling
        </option> 
        
         <option name="Output potential variant sites only">Forces SNP calling
        </option> 
        
         <option name="Type of prior"> 	Prior or initial allele frequency spectrum. Can be full, cond2 or flat.
        </option>
        
         <option name="Variant if P(ref|D)">A site is considered to be a variant if P(ref|D) is below specified threshold.
        </option>  
        
         <option name="Skip loci if fraction of samples covered is less than"> When "Output potential variant sites only" is in use, skip loci where the fraction of samples covered by reads is below the threshold.
        </option> 
        
         <option name="Constrained calling"> Enable pair/trio calling. For trio calling, option "List of samples to use" is usually needed to be applied to configure the trio members and their ordering. In the file supplied to the option "List of samples to use", the first sample must be the child, the second the father and the third the mother. The valid values are ‘pair’, ‘trioauto’, ‘trioxd’ and ‘trioxs’, where ‘pair’ calls differences between two input samples, and ‘trioxd’ (‘trioxs’) specifies that the input is from the X chromosome non-PAR regions and the child is a female (male)
        </option>        
        
         <option name="Scaled substitution mutation rate">Scaled mutation rate for variant calling
        </option> 
        
         <option name="Skip indels">
        </option> 
        
         <option name="Indel-to-substitution ratio"> Ratio of INDEL-to-SNP mutation rate
        </option> 
        
          <option name="*************** Contrast calling and association test options ***************">
        </option> 
        
         <option name="Number of group-1 samples"> This option is used for dividing the samples into two groups for contrast SNP calling or association test. When this option is in use, the following VCF INFO will be outputted: PC2, PCHI2 and QCHI2.
        </option> 

         <option name="Posterior contrast for P(ref|D) and LRT"> Posterior contrast for LRT Input and P(ref|D) below 0.5.
        </option> 
        
         <option name="Number of permutations for association testing"> Requires "Number of group-1 samples" option
        </option> 
        
         <option name="Only perform permutations for P(chi^2)"> Only perform permutations for P(chi^2) below Input threshold. Requires "Number of permutations for association testing" option.
        </option>         
 
      
    </fullDescription>
    
    <ports>
            <inPort index="0" name="Optional In-Port">**Optional Inport**<br></br>Cell 0: Path to Samtools<br></br>Cell 1: Path to Infile in BCF or VCF format(VCF for view only)</inPort>
        	<outPort index="0" name="Out-Port">Cell 0: Path to Bcftools<br></br>Cell 1: Path to BCF of VCF output file</outPort>
    </ports>    
    <views>
    <view index="0" name=""></view>
    </views>
</knimeNode>

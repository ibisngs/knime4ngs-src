<?xml version="1.0" encoding="UTF-8"?>
<knimeNode icon="./icon_d_green.png" type="Source" xmlns="http://knime.org/node/v2.8" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://knime.org/node/v2.10 http://knime.org/node/v2.10.xsd">
    <name>LOFSummary</name>
    
    <shortDescription>
        This node generates summary files for annotated LoF variants.
    </shortDescription>
    
    <fullDescription>
        <intro>
        	This node generates four tab separated summary files for annotated variants.
        	Furthermore, it generates a list of completely inactivated (KO) genes.
        	If all transcripts of a gene are homozygously affected by a LoF variant the gene is called KO gene.
        	If a PED file is given, two further gene lists are generated. 
        	The de_novo_KO_genes file contains genes that are completely inactivated in the child but not in the parents.
        	The de_novo_LOF_genes file contains genes that are affected by at least one LoF in the child and that are unaffected in the parents.
        	<ul>
        		<li>
        			The variant_summary comprises the following fields: chr, pos, rsId (if available), ref_allele, AF, alt_allele, gene_id, gene_symbol, effect (full or partial), consequence, lof_trans, all_trans, obs_hom, obs_het. 
        			The allele frequency (AF) is calculated according to the given genotypes and thus adjusted to genotypes that were set to "no call" as a consequence of preceding filtering.
        			The effect can only be calculated if a CDS file is given.
        			"Full" indicates that all transcripts of a gene are affected by a LoF variant.
        			Consequences of LoF variants are expressed using Sequence Ontology terms.
        			lof_trans contains the number of transcripts that are affected by the LoF variant.
        			all_trans contains the number of all transcripts of the gene (requires a CDS file).
        			obs_hom and obs_het indicate how often each variant is observed in a homozygous/heterozygous state.
        		</li>
        		<li>
        			The gene_summary comprises the following fields: gene_id, gene_symbol, full (LoF variants), partial (LoF variants), affected_samples and ko_samples.
        			The last both values indicate in how many samples the gene is affected or completely inactivated.
        		</li>
        		<li>
        			The sample_summary comprises the following fields: sample_id, full (LoF variants), partial (LoFs variants), affectedGenes, knocked_out (all transcripts are affected by at least one LoF variant), completeLOFgenes [list id:symbol].
        		</li>
        		<li>
        			The trio_summary comprises the following fields for each child: sample_id, de_novo_LOF, KOs_de_novo, de_novo_KO [list id:symbol].
        			The second and the third column contain numbers of de novo LOF and KO genes.
        			The last column contains a list of de novo KO genes for each child.
        		</li>
        	</ul>
        	Predecessor nodes (not required): VCFFilter or any node that outputs a VCF file.
        </intro>
        
        <option name="Path to VCF file">
        	Select annotated VCF file.
        </option>
        <option name="Path to CDS files">
        	Select CDS file which can be downloaded here:
        	<br />
        	<a href="http://www.ensembl.org/info/data/ftp/index.html">http://www.ensembl.org/info/data/ftp/index.html</a>
        	<br />
        	If this file is not provided, the effect of LoF variants (full or partial) cannot be calculated.
        </option>
        <option name="Path to PED file">
        	Select PED file. If this file ist not provided, neither a trio summary will be calculated nor de_novo_KO/LOF_genes will be written.
        </option>
        <option name="Annotation Selection">
        	Select the tool that was used to annotate the VCF file.
        	If LOFTEE was used, it is possible to restrict the statistics to high confidence LoF variants.
        	Moreover, the standard statistic additionally contains the fields confidence, failed_filters, lof_flags and lof_info.
        	Further information can be found here:
        	<br />
        	<a href="https://github.com/konradjk/loftee">https://github.com/konradjk/loftee</a>
        </option>
        
    </fullDescription>
    
    <ports>
        <inPort index="0" name="">Cell 0: Path to VCF file.</inPort>
        <outPort index="0" name="">
        	Cell 0: Path to variant summary file.
        	<br />
        	Cell 1: Path to gene summary file.
        	<br />
        	Cell 2: Path to sample summary file.
        	<br />
        	Cell 3: Path to transcript summary file.
        </outPort>
    </ports>    
    <views>
        <view index="0" name=""></view>
    </views>
</knimeNode>

<?xml version="1.0" encoding="UTF-8"?>
<knimeNode icon="./icon_d_green.png" type="Source" xmlns="http://knime.org/node/v2.8" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://knime.org/node/v2.10 http://knime.org/node/v2.10.xsd">
    <name>VCFFilter</name>
    
    <shortDescription>
        This node filters annotated VCF files.
    </shortDescription>
    
    <fullDescription>
        <intro>
        	This nodes allows to filter (annotated) VCF files in various ways.
        	It is based on VCFTools and the filtering script of VEP.
        	Default values are taken from <a href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC4098776/">Carson et al. (2014)</a>.
        	The output is a VCF file containing the variants that have passed the filters.
        </intro>
        
        <tab name="Options">
        	<option name="Select input file">
        		VCF file to be filtered.
        	</option>
        	<option name="Path to filter_vep.pl">
        		This script is used to filter VEP annotations.
        		It can be found in the VEP installation in ensembl-tools-release../scripts/variant_effect_predictor.
       	 	</option>
       	 	<option name="Path to VCFtools binaries">
        		Select path where the vcftools and find-ac-an binaries are located.
        	</option>
        	<option name="Further options">
        		VCFTools removes INFO fiels from VCF files. 
        		Allele counts (AC) and allele numbers (AN) are restored, if checked.
        	</option>
        	
        </tab>
        
        <tab name="Genotype Filter">
        	<option name="Filter by DP">
        		Genotypes are filtered by the given read depth (DP) threshold if this box is checked.
        		Make sure that DP values are given in the VCF file.
        	</option>
        	<option name="Filter by GQ">
        		Genotypes are filtered by the given genotype quality (GQ) threshold if this box is checked.
        		Make sure that GQ values are annotated in the VCF file.
        	</option>
        </tab>
        
        <tab name="Variant Filter">
        	<option name="Filter by FILTER is PASS">
        		Check this box, if you want to discard variants that have failed previous filters.
        	</option>
        	<option name="Filter by call rate">
        		Variants are discarded if the percentage of called genotypes is below the given threshold.
        	</option>
        	<option name="Filter by mean GQ">
        		Mean is computed internally, variants are completely removed if their mean GQ is below the threshold.
        	</option>
        </tab>
        
        <tab name="Annotation Filter">
        <option name="Select variants">
        	Choose some SO terms to define variants in which you are interested.
        	Variants that match at least one of the default terms are generally considered as Loss-of-Function variants. 
        </option>
        <option name="Filter Conditions">
        	Further filters can be defined for VCF files annotated by VEP.
        	If you want to find all high confidence LoFs having an ExAC allele frequency larger than 0.05 you would type:
        	LoF is HC,ExAC_AF>0.05 (requires the usage of the VEP plugins LOFTEE and ExAC).
        	More information can be found at:
        	<a href="http://www.ensembl.org/info/docs/tools/vep/script/vep_filter.html">http://www.ensembl.org/info/docs/tools/vep/script/vep_filter.html</a>
        </option>
        </tab>
        
    </fullDescription>
    
    <ports>
        <inPort index="0" name="">Cell 0: Path to VCF file.</inPort>
        <outPort index="0" name="Filtered VCF">Cell 0: Path to filtered VCF file.</outPort>
    </ports>    
</knimeNode>

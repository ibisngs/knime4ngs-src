<?xml version="1.0" encoding="UTF-8"?>
<knimeNode icon="./icon_d_green.png" type="Source" xmlns="http://knime.org/node/v2.8" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://knime.org/node/v2.10 http://knime.org/node/v2.10.xsd">
    <name>GeneBasedAnalysis</name>
    
    <shortDescription>
        Analyzes case-control sequencing studies on gene or transcript level. 
    </shortDescription>
    
    <fullDescription>
        <intro>
        	This node analyzes case-control sequencing studies on gene or transcript level based on the matrix file of the VEPSummary node.
        	It enables the identification of genes/transcripts that harbor significantly more variants in the case than in the control group.
        	To enhance the statistical power, the node is able to integrate variant frequencies of a large population background.
        </intro>
        
        <option name="Fisher's exact test">
        	The matrix file is used to generate contingency tables for each gene/transcript containing sample counts for variant/no variant and case/control group.
        	Based on this contingency tables, Fisher's exact test can be performed to test different alternative hypothesis:
        	choose greater if you want to find more variants in cases than in controls, 
        	choose less if you want to find more variants in controls than in cases or 
        	two.sided if you look for any significant differences in cases and controls.
        </option>
        <option name="Wilcoxon test">
        	The Wilcoxon test is applied to a case and a control vector for each gene/transcript.
        	The vectors contain numbers representing the affection state of the gene or transcript (0 = no variant, 1 = only heterozygous variants, 2 = at least one homozygous variant).
        	Analogously to Fisher's exact test, it is possible to test different alternative hypothesis.
        </option>
        <option name="Hypergeometric background">
        	Two Fisher's exact tests are performed for cases vs. background and controls vs. background.
        	To get statistically sound results you have to set the Background population size parameter correctly.
        </option>
        <option name="Model file settings">
        	Select the column of the gene identifier and the gene-based background frequency in the model file.
        	Specify the correct background population size to get valid results.
        </option>
    </fullDescription>
    
    <ports>
        <inPort index="0" name="Matrix file">
        	Matrix file generated by the VEPSummary node.
        </inPort>
        <inPort index="1" name="Background file">
        	Background file generated by the GeneticBackgroundModel node.
        </inPort>
        <outPort index="0" name="Analysis summary">
        	Summary file of analysis.
        </outPort>
    </ports>    
    </knimeNode>
